<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The Middlesex School - Checkout for After School Classes">
    <meta name="keywords" content="After School Classes, Checkout, Middlesex School">
    <meta name="author" content="Mithra Iyengar Ramprabu">
    <title>The Middlesex School - Checkout</title>
    <link rel="icon" type="image/x-icon" href="assets/the-mdx-school.png">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>
</head>

<body>
    <div id="checkout-app">
        <header>
            <nav>
                <figure>
                    <img style="width:50px;height:50px;" :src="school.logo" class="nav-logo" alt="School Logo">
                </figure>
                <p class="nav-item">Checkout</p>
            </nav>
        </header>

        <main>
            <section id="checkout-section" v-if="cart.length > 0">
                <h2>Your Cart</h2>
                <div v-for="(item, index) in cart" :key="item.id" class="cart-item">
                    <img :src="item.img" alt="Product Image" class="cart-item-img">
                    <h3>{{ item.title }}</h3>
                    <p>${{ item.price }}</p>
                    <p>Quantity: {{ item.quantity }}</p>
                    
                    <button @click="increaseQuantity(item)" :disabled="item.availability <= 0">
                        <i class="fa fa-plus"></i>
                    </button>

                    <button @click="decreaseQuantity(item)">
                        <i class="fa fa-minus"></i>
                    </button>

                    <button @click="removeFromCart(item)">
                        Remove <i class="fa fa-trash"></i>
                    </button>
                </div>

                <p>Total: ${{ cartTotal }}</p>
                
                <button class="checkout-btn" @click="proceedToPayment">
                    Proceed to Payment
                </button>
            </section>

            <section v-else>
                <p>Your cart is empty. Please add some items before proceeding.</p>
            </section>
        </main>
    </div>

    <script>
    new Vue({
        el: '#checkout-app',
        data: {
            school: {
                name: 'The Middlesex School',
                logo: 'assets/the-mdx-school.png'
            },
            cart: []
        },
        computed: {
            cartTotal() {
                return this.cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            }
        },
        methods: {
            loadCart() {
                const savedCart = JSON.parse(localStorage.getItem('cart')) || [];
                this.cart = savedCart;
            },
            
            increaseQuantity(item) {
                if (item.quantity < item.availability) {
                    item.quantity += 1;
                    item.availability -= 1;
                    this.updateLocalStorage();
                }
            },

            decreaseQuantity(item) {
                if (item.quantity > 1) {
                    item.quantity -= 1;
                    item.availability += 1;
                    this.updateLocalStorage();
                }
            },

            removeFromCart(item) {
                const index = this.cart.findIndex(cartItem => cartItem.id === item.id);
                if (index !== -1) {
                    this.cart.splice(index, 1);
                    this.updateLocalStorage();
                }
            },

            updateLocalStorage() {
                localStorage.setItem('cart', JSON.stringify(this.cart));
            },

            proceedToPayment() {
                // Placeholder for payment logic or redirect to payment page
                alert('Proceeding to payment...');
            }
        },
        mounted() {
            this.loadCart();
        }
    });
    </script>
</body>
</html>
